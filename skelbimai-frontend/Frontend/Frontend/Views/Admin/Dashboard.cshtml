@model IEnumerable<Frontend.Models.Users>
@{
    ViewData["Title"] = "Dashboard";
    Layout = "_AdminLayout";
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap Table with Add and Delete Row Feature</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round|Open+Sans">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    @*<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">*@
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <script src="https://static.codepen.io/assets/common/stopExecutionOnTimeout-de7e2ef6bfefd24b79a3f68b414b87b8db5b08439cac3f1012092b2290c719cd.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

    <script src="https://canvasjs.com/assets/script/canvasjs.min.js" type="text/javascript"></script>

    <title>Bootstrap 4 DatePicker</title>
    <script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js" type="text/javascript"></script>
    <link href="https://unpkg.com/gijgo@1.9.13/css/gijgo.min.css" rel="stylesheet" type="text/css" />



    <link rel="stylesheet" href="~/css/login.css">
    <link rel="stylesheet" href="~/css/site.css">

    <style type="text/css">
        .search-box input:focus {
            border-color: #3FBAE4;
        }

        .search-box i {
            color: #a0a5b1;
            position: absolute;
            font-size: 19px;
            top: 8px;
            left: 10px;
        }

        .table-wrapper {
            width: 700px;
            margin: 30px auto;
            background: #fff;
            padding: 20px;
            box-shadow: 0 1px 1px rgba(0,0,0,.05);
        }

        .table-title {
            padding-bottom: 10px;
            margin: 0 0 10px;
        }

            .table-title h2 {
                margin: 6px 0 0;
                font-size: 22px;
            }

            .table-title .add-new {
                float: right;
                height: 30px;
                font-weight: bold;
                font-size: 12px;
                text-shadow: none;
                min-width: 100px;
                border-radius: 50px;
                line-height: 13px;
            }

                .table-title .add-new i {
                    margin-right: 4px;
                }

        table.table {
            table-layout: fixed;
        }

            table.table tr th, table.table tr td {
                border-color: #e9e9e9;
            }

            table.table th i {
                font-size: 13px;
                margin: 0 5px;
                cursor: pointer;
            }

            table.table th:last-child {
                width: 100px;
            }

            table.table td a {
                cursor: pointer;
                display: inline-block;
                margin: 0 5px;
                min-width: 24px;
            }

                table.table td a.add {
                    color: #27C46B;
                }

                table.table td a.edit {
                    color: #FFC107;
                }

                table.table td a.delete {
                    color: #E34724;
                }

            table.table td i {
                font-size: 19px;
            }

            table.table td a.add i {
                font-size: 24px;
                margin-right: -1px;
                position: relative;
                top: 3px;
            }

            table.table .form-control {
                height: 32px;
                line-height: 32px;
                box-shadow: none;
                border-radius: 2px;
            }

                table.table .form-control.error {
                    border-color: #f50000;
                }

            table.table td .add {
                display: none;
            }

        ::-webkit-scrollbar {
            width: 0px;
            background: transparent; /* make scrollbar transparent */
        }
        /* Style the counter cards */
        .card {
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
            padding: 16px;
        }

        .fa {
            font-size: 50px;
        }
    </style>
    <style>
        .card-signin {
            border: 0;
            border-radius: 0rem;
            box-shadow: 0 0.5rem 1rem 0 rgba(0, 0, 0, 0.1);
        }

            .card-signin .card-title {
                margin-bottom: 2rem;
                font-weight: 300;
                font-size: 1.5rem;
            }

            .card-signin .card-body {
                padding: 2rem;
            }
    </style>
    <script type="text/javascript">
        function makeGraph(id, month, year) {
            $.ajax({
                type: 'POST',
                dataType: 'JSON',
                url: '/admin/graph',
                data: {
                    'graphType': id,
                    'year': year,
                    'month': month
                },
                success: function (data) {
                    if (id == 1) {
                        var chart2 = new CanvasJS.Chart("chartContainer1", {
                            title: {
                                text: "Ads"
                            },
                            data: [
                                {
                                    // Change type to "doughnut", "line", "splineArea", etc.
                                    type: "splineArea",
                                    dataPoints: [
                                        { label: "Jan", y: data.jan },
                                        { label: "Feb", y: data.feb },
                                        { label: "Mar", y: data.mar },
                                        { label: "Apr", y: data.apr },
                                        { label: "May", y: data.may },
                                        { label: "Jun", y: data.jun },
                                        { label: "Jul", y: data.jul },
                                        { label: "Aug", y: data.aug },
                                        { label: "Sep", y: data.sep },
                                        { label: "Oct", y: data.oct },
                                        { label: "Nov", y: data.nov },
                                        { label: "Dec", y: data.dec }
                                    ]
                                }
                            ]
                        });
                        chart2.render();
                    } else if (id == 2) {
                        var chart1 = new CanvasJS.Chart("chartContainer1", {
                            title: {
                                text: "Rating"
                            },
                            data: [
                                {
                                    // Change type to "doughnut", "line", "splineArea", etc.
                                    type: "doughnut",
                                    dataPoints: [
                                        { label: "one", y: data.one },
                                        { label: "two", y: data.two },
                                        { label: "three", y: data.three },
                                        { label: "four", y: data.four },
                                        { label: "five", y: data.five }
                                    ]
                                }
                            ]
                        });
                        chart1.render();
                    } else {
                        var chart2 = new CanvasJS.Chart("chartContainer1", {
                            title: {
                                text: "Comments activity"
                            },
                            data: [
                                {
                                    // Change type to "doughnut", "line", "splineArea", etc.
                                    type: "splineArea",
                                    dataPoints: [
                                        { label: "Jan", y: data.jan },
                                        { label: "Feb", y: data.feb },
                                        { label: "Mar", y: data.mar },
                                        { label: "Apr", y: data.apr },
                                        { label: "May", y: data.may },
                                        { label: "Jun", y: data.jun },
                                        { label: "Jul", y: data.jul },
                                        { label: "Aug", y: data.aug },
                                        { label: "Sep", y: data.sep },
                                        { label: "Oct", y: data.oct },
                                        { label: "Nov", y: data.nov },
                                        { label: "Dec", y: data.dec }
                                    ]
                                }
                            ]
                        });
                        chart2.render();
                    }
                },
                error: function () {
                    //location.href = '/forum/discussion?id=' + id
                    // add error message or smth
                    alert("UwU");
                }
            });
        }
    </script>


    <script type="text/javascript">
        $(document).ready(function () {
            $('[data-toggle="tooltip"]').tooltip();
            var actions = $("table td:last-child").html();
            // Append table with add row form on add new button click
            $(".add-new").click(function () {
                $(this).attr("disabled", "disabled");
                var index = $("table tbody tr:last-child").index();
                var row = '<tr>' +
                    '<td><input type="text" class="form-control" name="name" id="name"></td>' +
                    '<td><input type="text" class="form-control" name="role" id="role"></td>' +

                    '</tr>';
                $("table").append(row);
                $("table tbody tr").eq(index + 1).find(".add, .edit").toggle();
                $('[data-toggle="tooltip"]').tooltip();
            });


            // Filter table rows based on searched term
            $("#search").on("keyup", function () {
                var term = $(this).val().toLowerCase();
                $("table tbody tr").each(function () {
                    $row = $(this);
                    var name = $row.find("td:nth-child(1)").text().toLowerCase();
                    console.log(name);
                    if (name.search(term) < 0) {
                        $row.hide();
                    } else {
                        $row.show();
                    }
                });
            });

        });
    </script>
</head>
<body>

    <!--Main layout-->
    <div class="mt-0 pt-0">
        <div class="container dark-grey-text mt-5">
            <!--Grid row-->
            <div class="row wow fadeIn">
                <!--Grid column-->
                <div class="col-md-9 mb-4">


                    <div class="card" style="">

                        <div class="card-body ">
                            <div class="row">
                                <div class="search-box col">
                                    <h4>User <b>Details</b></h4>
                                </div>
                            </div>

                            <div class="row">
                                <div class="search-box col-sm-9 mb-3">
                                    <div class="input-group">
                                        <input type="text" id="search" class="form-control rounded" placeholder="Search by Name">
                                        <span class="input-group-addon"><i class="material-icons"></i></span>
                                    </div>
                                </div>

                                <div class="form-group col-sm-3">
                                    <!--		Show Numbers Of Rows 		-->
                                    <select class="form-control" name="state" id="maxRows">
                                        <option value="5000">Show ALL Rows</option>
                                        <option value="5">5</option>
                                        <option value="10">10</option>
                                        <option value="15">15</option>
                                        <option value="20">20</option>

                                    </select>

                                </div>
                            </div>

                            <table class="table table-bordered" id="table-id">
                                <thead>
                                    <tr>
                                        <th style="width:70%;">Username</th>
                                        <th style="width:30%;">Role</th>

                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var user in Model)
                                    {
                                        <tr>
                                            <td>
                                                <a href="EditUserForm?id=@user.Id">@user.Username</a>
                                            </td>
                                            @if (user.Role == 1)
                                            {
                                                <td>User</td>
                                            }
                                            else
                                            {
                                                <td>Administrator</td>
                                            }
                                        </tr>
                                    }

                                </tbody>
                            </table>



                            <!--		Start Pagination -->
                            <div class='pagination-container'>
                                <ul class="pagination">

                                    <li data-page="prev">
                                        <span> < <span class="sr-only">(current)</span></span>
                                    </li>
                                    <!--	Here the JS Function Will Add the Rows -->
                                    <li data-page="next" id="prev">
                                        <span> > <span class="sr-only">(current)</span></span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <!--Grid column-->
                <!--Grid column-->
                <div class="col-md-3 mb-4">

                    <!--Content-->
                    <div class="card mb-3" style=" background-color: #444;color: white; text-align:center">

                        <p><i class="fa fa-user"></i></p>
                        <h3>@ViewBag.usersCount</h3>
                        <p>Users</p>
                    </div>


                    <div class="card " style=" background-color: #444;color: white; text-align:center">
                        <p><i class="fa fa-check"></i></p>
                        <h3>@ViewBag.adsCount</h3>
                        <p>Ads</p>
                    </div>
                    <!--Content-->

                </div>
                <!--Grid column-->

            </div>
            <!--Grid row-->
            <!--Grid row-->
            <!--Grid row-->
            <div class="row d-flex justify-content-center ">

                <!--Grid column-->
                <div class="col">
                    <div class="container-fluid bg-transparent ">
                        <div class="row mb-3">
                            <div class="col-sm-3">
                                <article class="card-group-item  bg-primary rounded">
                                    <header class="card-header text-center bg-light">
                                        <span>Amount of ads </span>
                                    </header>
                                    <div class="filter-content ">
                                        <div class="card-body ">
                                            <div class="form-row d-flex justify-content-center" id="myGroup">
                                                <div class="mb-3 bg-light rounded">
                                                    <div class="dropdown ">
                                                        <button class="btn btn-light  dropdown-toggle" type="button" id="dropdownMenu3" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                            Filter
                                                        </button>
                                                        <div class="dropdown-menu" aria-labelledby="dropdownMenu3">
                                                            <!--<div class="dropdown-item btn btn-dark w-100 mb-1">
                                        <a class="active nav-link" data-toggle="collapse" href="#multiCollapseExample1" role="button" aria-expanded="true" aria-controls="multiCollapseExample1">Week</a>
                                    </div>-->

                                                            <div class="dropdown-item btn btn-dark w-100 mb-1">
                                                                <a class="active nav-link" data-toggle="collapse" href="#multiCollapseExample3" role="button" aria-expanded="false" aria-controls="multiCollapseExample3">Month</a>
                                                            </div>
                                                            <div class="dropdown-item btn btn-dark w-100 mb-1">
                                                                <a class="active nav-link" data-toggle="collapse" href="#multiCollapseExample4" role="button" aria-expanded="false" aria-controls="multiCollapseExample4">Year</a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>


                                                <form>
                                                    <div class="collapse" id="multiCollapseExample3" data-parent="#myGroup">

                                                        <div class="bg-light rounded">
                                                            <div class="card-body">
                                                                <select required class="bg-primary custom-select bg-light col-sm-auto mb-3" name="year">
                                                                    <option value="" disabled selected>Year</option>
                                                                    <option value="2017">2017</option>
                                                                    <option value="2018">2018</option>
                                                                    <option value="2019">2019</option>

                                                                </select>
                                                                <select required class="bg-primary custom-select bg-light col-sm-auto" name="month">
                                                                    <option value="" disabled selected>Month</option>
                                                                    <option value="1">January</option>
                                                                    <option value="2">February</option>
                                                                    <option value="3">March</option>
                                                                    <option value="4">April</option>
                                                                    <option value="5">May</option>
                                                                    <option value="6">June</option>
                                                                    <option value="7">July</option>
                                                                    <option value="8">August</option>
                                                                    <option value="9">September</option>
                                                                    <option value="10">October</option>
                                                                    <option value="11">November</option>
                                                                    <option value="12">December</option>
                                                                </select>
                                                            </div>
                                                            <div class="col d-flex justify-content-end mb-3">
                                                                <input class="btn btn-primary mb-3" type="button" value="Show stats" onclick="makeGraph(1, month.value, year.value)"/>
                                                            </div>
                                                        </div>

                                                    </div>
                                                </form>
                                                <form>
                                                    <div class="collapse" id="multiCollapseExample4" data-parent="#myGroup">
                                                        <div class="bg-light rounded">
                                                            <div class="card-body">
                                                                <select required class="bg-primary custom-select bg-light col-sm-auto " name="year">
                                                                    <option value="" disabled selected>Year</option>
                                                                    <option value="2017">2017</option>
                                                                    <option value="2018">2018</option>
                                                                    <option value="2019">2019</option>
                                                                </select>
                                                            </div>
                                                            <div class="col d-flex justify-content-end mb-3">
                                                                <input class="btn btn-primary mb-3" type="button" onclick="makeGraph(1, 0, year.value)" value="Show stats"/>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                        </div> <!-- card-body.// -->
                                    </div>
                                </article> <!-- card-group-item.// -->
                            </div>
                            <div class="col-sm-3">
                                <article class="card-group-item bg-warning rounded">
                                    <header class="card-header text-center bg-light">
                                        <span>Rating</span>
                                        <span style="color:#ffbb33;">&#9733;&#9733;&#9733;&#9733;&#9733;</span>
                                    </header>
                                    <div class="filter-content ">
                                        <div class="card-body d-flex justify-content-center mb-3">
                                            <form>
                                                <input class="btn btn-primary mb-3" type="button" value="Show stats" onclick="makeGraph(2)" />
                                            </form>
                                        </div>
                                    </div>
                                </article>
                            </div>
                            <div class="col-sm-3">
                                <article class="card-group-item  rounded" style="background: #1de9b6">
                                    <header class="card-header text-center bg-light">
                                        <span>Activity in comments </span>
                                    </header>
                                    <div class="filter-content ">
                                        <div class="card-body ">
                                            <div class="form-row d-flex justify-content-center" id="myGroup2">
                                                <div class="mb-3 bg-light rounded">
                                                    <div class="dropdown ">
                                                        <button class="btn btn-light  dropdown-toggle" type="button" id="dropdownMenu4" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                                            Filter
                                                        </button>
                                                        <div class="dropdown-menu" aria-labelledby="dropdownMenu4">
                                                            <!--<div class="dropdown-item btn btn-dark w-100 mb-1">
                                        <a class="active nav-link" data-toggle="collapse" href="#multiCollapseExample1" role="button" aria-expanded="true" aria-controls="multiCollapseExample1">Week</a>
                                    </div>-->

                                                            <div class="dropdown-item btn btn-dark w-100 mb-1">
                                                                <a class="active nav-link" data-toggle="collapse" href="#multiCollapseExample6" role="button" aria-expanded="false" aria-controls="multiCollapseExample6">Month</a>
                                                            </div>
                                                            <div class="dropdown-item btn btn-dark w-100 mb-1">
                                                                <a class="active nav-link" data-toggle="collapse" href="#multiCollapseExample7" role="button" aria-expanded="false" aria-controls="multiCollapseExample7">Year</a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>


                                                <form>
                                                    <div class="collapse" id="multiCollapseExample6" data-parent="#myGroup2">
                                                        <div class="bg-light rounded">
                                                            <div class="card-body">
                                                                <select required class="bg-primary custom-select bg-light col-sm-auto mb-3" name="year">
                                                                    <option value="" disabled selected>Year</option>
                                                                    <option value="2017">2017</option>
                                                                    <option value="2018">2018</option>
                                                                    <option value="2019">2019</option>
                                                                </select>
                                                                <select required class="bg-primary custom-select bg-light col-sm-auto" name="month">
                                                                    <option value="" disabled selected>Month</option>
                                                                    <option value="1">January</option>
                                                                    <option value="2">February</option>
                                                                    <option value="3">March</option>
                                                                    <option value="4">April</option>
                                                                    <option value="5">May</option>
                                                                    <option value="6">June</option>
                                                                    <option value="7">July</option>
                                                                    <option value="8">August</option>
                                                                    <option value="9">September</option>
                                                                    <option value="10">October</option>
                                                                    <option value="11">November</option>
                                                                    <option value="12">December</option>
                                                                </select>
                                                            </div>
                                                            <div class="col d-flex justify-content-end mb-3">
                                                                <input class="btn btn-primary mb-3" type="button" onclick="makeGraph(3, month.value, year.value)" value="Show stats"/>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </form>
                                                <form>
                                                    <div class="collapse" id="multiCollapseExample7" data-parent="#myGroup2">
                                                        <div class="bg-light rounded">
                                                            <div class="card-body">

                                                               <select required class="bg-primary custom-select bg-light col-sm-auto " name="year">
                                                                    <option value="" disabled selected>Year</option>
                                                                    <option value="2017">2017</option>
                                                                    <option value="2018">2018</option>
                                                                    <option value="2019">2019</option>
                                                                </select>
                                                            </div>
                                                            <div class="col d-flex justify-content-end mb-3">
                                                                <input class="btn btn-primary mb-3" type="button" onclick="makeGraph(3, 0, year.value)" value="Show stats"/>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                        </div> <!-- card-body.// -->
                                    </div>
                                </article> <!-- card-group-item.// -->
                            </div>
                        </div>
                    </div>
                </div>
                <!--Grid column-->
            </div>
            <div class="mt-5 pt-0">
                <div class="container dark-grey-text mt-5">
                    <div class="card card-signin my-0">

                        <div class="card-body">
                            <div class="row ">
                                <div class="col-md-12 ">
                                    <div id="chartContainer1" style="height: 300px; width:100%;"></div>
                                </div>

                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--Main layout-->
    </div>

    <script>
        getPagination('#table-id');

        function getPagination(table) {

            var lastPage = 1;

            $('#maxRows').on('change', function (evt) {
                //$('.paginationprev').html('');						// reset pagination


                lastPage = 1;
                $('.pagination').find("li").slice(1, -1).remove();
                var trnum = 0;									// reset tr counter
                var maxRows = parseInt($(this).val());			// get Max Rows from select option

                if (maxRows == 5000) {

                    $('.pagination').hide();
                } else {

                    $('.pagination').show();
                }

                var totalRows = $(table + ' tbody tr').length;		// numbers of rows
                $(table + ' tr:gt(0)').each(function () {			// each TR in  table and not the header
                    trnum++;									// Start Counter
                    if (trnum > maxRows) {						// if tr number gt maxRows

                        $(this).hide();							// fade it out
                    } if (trnum <= maxRows) { $(this).show(); }// else fade in Important in case if it ..
                });											//  was fade out to fade it in
                if (totalRows > maxRows) {						// if tr total rows gt max rows option
                    var pagenum = Math.ceil(totalRows / maxRows);	// ceil total(rows/maxrows) to get ..
                    //	numbers of pages
                    for (var i = 1; i <= pagenum;) {			// for each page append pagination li
                        $('.pagination #prev').before('<li data-page="' + i + '">\
                                                                                                                                                                                                                          <span>'+ i++ + '<span class="sr-only">(current)</span></span>\
                                                                                                                                                                                                                        </li>').show();
                    }											// end for i
                } 												// end if row count > max rows
                $('.pagination [data-page="1"]').addClass('active'); // add active class to the first li
                $('.pagination li').on('click', function (evt) {		// on click each page
                    evt.stopImmediatePropagation();
                    evt.preventDefault();
                    var pageNum = $(this).attr('data-page');	// get it's number

                    var maxRows = parseInt($('#maxRows').val());			// get Max Rows from select option

                    if (pageNum == "prev") {
                        if (lastPage == 1) { return; }
                        pageNum = --lastPage;
                    }
                    if (pageNum == "next") {
                        if (lastPage == ($('.pagination li').length - 2)) { return; }
                        pageNum = ++lastPage;
                    }

                    lastPage = pageNum;
                    var trIndex = 0;							// reset tr counter
                    $('.pagination li').removeClass('active');	// remove active class from all li
                    $('.pagination [data-page="' + lastPage + '"]').addClass('active');// add active class to the clicked
                    // $(this).addClass('active');					// add active class to the clicked
                    $(table + ' tr:gt(0)').each(function () {		// each tr in table not the header
                        trIndex++;								// tr index counter
                        // if tr index gt maxRows*pageNum or lt maxRows*pageNum-maxRows fade if out
                        if (trIndex > (maxRows * pageNum) || trIndex <= ((maxRows * pageNum) - maxRows)) {
                            $(this).hide();
                        } else { $(this).show(); } 				//else fade in
                    }); 										// end of for each tr in table
                });										// end of on click pagination list

            }).val(5).change();

            // END OF PAGINATION
        }

    </script>

</body>
</html>
